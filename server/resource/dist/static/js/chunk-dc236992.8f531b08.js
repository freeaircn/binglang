(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dc236992"],{"03fb":function(t,e,n){"use strict";var a=n("2031"),i=n.n(a);i.a},2031:function(t,e,n){},"2f21":function(t,e,n){"use strict";var a=n("79e5");t.exports=function(t,e){return!!t&&a((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"55dd":function(t,e,n){"use strict";var a=n("5ca1"),i=n("d8e8"),r=n("4bf8"),o=n("79e5"),l=[].sort,s=[1,2,3];a(a.P+a.F*(o((function(){s.sort(void 0)}))||!o((function(){s.sort(null)}))||!n("2f21")(l)),"Array",{sort:function(t){return void 0===t?l.call(r(this)):l.call(r(this),i(t))}})},"73a3":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-select",{ref:"select",attrs:{value:t.valueId,placeholder:t.placeholder},on:{"visible-change":t.handleVisible}},[n("el-option",{attrs:{value:t.valueId,label:t.valueLabel}},[n("el-tree",{ref:"selectTree",attrs:{data:t.options,props:t.props,"node-key":t.nodeKey},on:{"node-click":t.handleNodeClick}})],1)],1)},i=[],r={name:"TreeSelect",props:{value:{type:String,default:function(){return""}},options:{type:Array,default:function(){return[]}},nodeKey:{type:String,default:function(){return"id"}},props:{type:Object,default:function(){return{label:"label",children:"children"}}},accordion:{type:Boolean,default:function(){return!1}},placeholder:{type:String,default:function(){return"请选择"}}},data:function(){return{valueId:this.value,valueLabel:""}},watch:{value:function(t){var e=this;this.$nextTick((function(){e.$refs["selectTree"].getNode(t)?(e.valueLabel=e.$refs["selectTree"].getNode(t).data[e.props.label],e.valueId=t):(e.valueLabel="",e.valueId="")}))}},mounted:function(){this.$refs["selectTree"].getNode(this.valueId)?this.valueLabel=this.$refs["selectTree"].getNode(this.valueId).data[this.props.label]:this.valueLabel=""},methods:{handleNodeClick:function(t){this.$emit("update:value",t[this.nodeKey]),this.$refs["select"].blur()}}},o=r,l=(n("03fb"),n("2877")),s=Object(l["a"])(o,a,i,!1,null,"bca35a70",null);e["a"]=s.exports},7831:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return p}));var a=/^([1-9][0-9]*)$/,i=/^([\u4e00-\u9fa5]){1,15}$/,r=/^([A-z\u4E00-\u9FA5]{1,40})$/,o=/^[a-z_]{1,60}$/,l=/^[1][3,4,5,7,8][0-9]{9}$/,s=/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,c=/^([0-9]{1,17}[0-9x])$/;function u(t,e,n){return e?i.test(e)?void n():n(new Error("请输入中文")):n()}function d(t,e,n){return e?r.test(e)?void n():n(new Error("请输入中文或英文")):n()}function f(t,e,n){return e?o.test(e)?void n():n(new Error("允许输入小写英文或下划线")):n()}function p(t,e,n){return e?i.test(e)?n():s.test(e)?n():l.test(e)?n():c.test(e)?n():a.test(e)?n():n(new Error("输入字符不合规")):n()}},c179:function(t,e,n){"use strict";n.d(e,"f",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return p})),n.d(e,"b",(function(){return h}));var a=/^([1-9][0-9]*)$/,i=/^([\u4e00-\u9fa5]){1,15}$/,r=/^([A-z\u4E00-\u9FA5]{1,40})$/,o=/^[a-z_]{1,60}$/,l=/^[1][3,4,5,7,8][0-9]{9}$/,s=/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/;function c(t,e,n){return e&&a.test(e)?void n():n(new Error("请输入正整数"))}function u(t,e,n){return e&&i.test(e)?void n():n(new Error("请输入中文，最多15个"))}function d(t,e,n){return e&&r.test(e)?void n():n(new Error("请输入中文或英文，最多40个"))}function f(t,e,n){return e&&o.test(e)?void n():n(new Error("请输入小写字母或下划线，最多60个"))}function p(t,e,n){return e&&l.test(e)?void n():n(new Error("请输入11位手机号码"))}function h(t,e,n){return e&&s.test(e)?void n():n(new Error("请输入有效的电子邮箱"))}},f53d:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"head-container"},[n("SearchOptions",{attrs:{inputs:t.searchOptionsInputs,rules:t.searchOptionsRules},on:{"click-search":t.handleSearch,change:t.searchChange}}),t._v(" "),n("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-plus"},on:{click:t.preCreate}},[t._v("新增")])],1),t._v(" "),n("el-divider",[n("i",{staticClass:"el-icon-arrow-down"})]),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"table",attrs:{data:t.tableData,"tree-props":{children:"children",hasChildren:"hasChildren"},"default-expand-all":!0,"row-key":"id",size:"small","header-cell-style":{background:"#F2F6FC",color:"#606266"}}},[n("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"label",label:"标签"}}),t._v(" "),n("el-table-column",{attrs:{prop:"sort",label:"序号"}}),t._v(" "),n("el-table-column",{attrs:{prop:"enabled",label:"是否启用",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.enabled?n("span",[t._v("是")]):n("span",[t._v("否")])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"update_time",label:"更新日期"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"130px",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(e){return t.preUpdate(a.id)}}}),t._v(" "),n("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.doDelete(a.id)}}})]}}])})],1),t._v(" "),n("el-dialog",{attrs:{"append-to-body":"","close-on-click-modal":!1,visible:t.dialogVisible,title:t.dialogActionMap[t.dialogAction],width:"400px"},on:{"update:visible":function(e){t.dialogVisible=e},closed:t.closedDialog}},[n("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules,size:"small","label-width":"80px"}},[n("el-form-item",{attrs:{label:"标签",prop:"label"}},[n("el-input",{model:{value:t.formData.label,callback:function(e){t.$set(t.formData,"label",e)},expression:"formData.label"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"序号",prop:"sort"}},[n("el-input-number",{model:{value:t.formData.sort,callback:function(e){t.$set(t.formData,"sort",e)},expression:"formData.sort"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"是否启用",prop:"enabled"}},[n("el-radio-group",{attrs:{size:"mini"},model:{value:t.formData.enabled,callback:function(e){t.$set(t.formData,"enabled",e)},expression:"formData.enabled"}},[n("el-radio-button",{attrs:{label:"1"}},[t._v("是")]),t._v(" "),n("el-radio-button",{attrs:{label:"0"}},[t._v("否")])],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"上级部门",prop:"pid"}},[n("TreeSelect",{attrs:{value:t.formData.pid,options:t.treeData,placeholder:"选择上级部门"},on:{"update:value":function(e){return t.$set(t.formData,"pid",e)}}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.cancelDialog()}}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){"create"===t.dialogAction?t.doCreate():t.doUpdate()}}},[t._v("提交")])],1)],1)],1)},i=[],r=(n("55dd"),n("ac6a"),n("5df3"),n("fa20")),o=n("7831");function l(){return{data:function(){return{searchOptionsInputs:[{prop:"label",placeholder:"字段：标签",tooltip:"查询字段：标签",maxlength:15,width:150}],searchOptionsRules:{label:[{validator:o["b"],trigger:"blur"}]}}}}}var s=l,c=n("73a3"),u=n("c179"),d=n("b775");function f(t){return Object(d["a"])({url:"/api/dept",method:"get",params:t})}function p(t){return Object(d["a"])({url:"/api/dept",method:"post",data:t})}function h(t){return Object(d["a"])({url:"/api/dept",method:"put",data:t})}function m(t){return d["a"].delete("/api/dept",{data:{id:t}})}var b={name:"AdminDept",components:{SearchOptions:r["a"],TreeSelect:c["a"]},mixins:[s()],data:function(){return{query:{},tableLoading:!1,tableData:[],treeData:[],dialogVisible:!1,dialogAction:"",dialogActionMap:{update:"编辑",create:"新建"},formData:{id:"",sort:"1",label:"",enabled:"1",pid:""},rules:{sort:[{required:!0,validator:u["f"],trigger:"change"}],label:[{required:!0,validator:u["c"],trigger:"change"}]}}},methods:{refreshTblDisplay:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.tableLoading=!0;var e=JSON.parse(JSON.stringify(t));f(e).then(function(t){this.tableData.splice(0),this.tableData=t.dept.slice(0)}.bind(this)).catch(function(t){this.tableData.splice(0),this.$message({message:t,type:"warning"})}.bind(this)).finally(function(){this.tableLoading=!1}.bind(this))},preCreate:function(){this.rstFormData(),f({req:"id_label_pid"}).then(function(t){var e=this;this.treeData.splice(0),this.treeData=t.dept_list.slice(0),this.dialogAction="create",this.dialogVisible=!0,this.$nextTick((function(){e.$refs["form"].clearValidate()}))}.bind(this)).catch(function(t){this.tableData.splice(0),this.$message({message:t,type:"warning"})}.bind(this))},doCreate:function(){var t=this;this.$refs["form"].validate((function(e){e&&p(t.formData).then(function(t){var e=this;this.dialogAction="",this.dialogVisible=!1,this.$nextTick((function(){e.rstFormData(),e.refreshTblDisplay(e.query)}))}.bind(t)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(t))}))},preUpdate:function(t){this.rstFormData(),Promise.all([f({req:"id_label_pid"}),f({id:t})]).then(function(t){var e=this;this.treeData.splice(0),this.treeData=t[0].dept_list.slice(0),this.updateFormData(t[1]["form"]),this.dialogAction="update",this.dialogVisible=!0,this.$nextTick((function(){e.$refs["form"].clearValidate()}))}.bind(this)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(this))},doUpdate:function(){var t=this;this.$refs["form"].validate((function(e){e&&h(t.formData).then(function(t){var e=this;this.dialogAction="",this.dialogVisible=!1,this.$nextTick((function(){e.rstFormData(),e.refreshTblDisplay(e.query)}))}.bind(t)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(t))}))},doDelete:function(t){var e=this;this.$confirm("确定删除吗？将同时删除子节点","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){m(t).then(function(t){var e=this;this.$nextTick((function(){e.refreshTblDisplay(e.query)}))}.bind(e)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(e))})).catch((function(){}))},rstFormData:function(){this.formData.id="",this.formData.sort="1",this.formData.label="",this.formData.enabled="1",this.formData.pid=""},updateFormData:function(t){this.formData.id=t.id,this.formData.sort=t.sort,this.formData.label=t.label,this.formData.enabled=t.enabled,this.formData.pid=t.pid},cancelDialog:function(){this.dialogAction="",this.dialogVisible=!1},closedDialog:function(){this.rstFormData()},handleSearch:function(t){this.query=JSON.parse(JSON.stringify(t)),this.refreshTblDisplay(this.query)},searchChange:function(t){this.query=JSON.parse(JSON.stringify(t)),this.refreshTblDisplay(this.query)}}},v=b,g=n("2877"),y=Object(g["a"])(v,a,i,!1,null,null,null);e["default"]=y.exports},fa20:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"search-options"},[n("el-form",{ref:"form",attrs:{model:t.query,rules:t.rules,inline:!0,size:"mini"}},[t._l(t.inputs,(function(e,a){return n("el-form-item",{key:e.prop+"_"+a,attrs:{prop:e.prop}},[n("el-tooltip",{attrs:{effect:"dark",content:e.tooltip,placement:"top"}},[n("el-input",{style:{width:e.width+"px"},attrs:{placeholder:e.placeholder,maxlength:e.maxlength},on:{change:t.inputChange},model:{value:t.query[e.prop],callback:function(n){t.$set(t.query,e.prop,n)},expression:"query[item.prop]"}})],1)],1)})),t._v(" "),t._l(t.selects,(function(e,a){return n("el-form-item",{key:e.prop+"_"+a,attrs:{prop:e.prop}},[n("el-tooltip",{attrs:{effect:"dark",content:e.tooltip,placement:"top"}},[n("el-select",{style:{width:e.width+"px"},attrs:{placeholder:e.placeholder},on:{change:t.selectChange},model:{value:t.query[e.prop],callback:function(n){t.$set(t.query,e.prop,n)},expression:"query[item.prop]"}},t._l(e.options,(function(t,i){return n("el-option",{key:e.prop+"_"+a+"_"+i,attrs:{label:t.label,value:t.value}})})),1)],1)],1)})),t._v(" "),n("el-form-item",[n("el-tooltip",{attrs:{effect:"dark",content:"各字段按“与”组合查询",placement:"top"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleQuery}},[t._v("查询")])],1),t._v(" "),n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh-left"},on:{click:function(e){return e.preventDefault(),t.resetForm(e)}}},[t._v("清空")])],1)],2)],1)},i=[],r={name:"SearchOptions",props:{inputs:{type:Array,default:function(){return[]}},selects:{type:Array,default:function(){return[]}},rules:{type:Array,default:function(){return[]}}},data:function(){return{query:{}}},created:function(){for(var t in this.inputs)this.$set(this.query,this.inputs[t].prop,"");for(var e in this.selects)this.$set(this.query,this.selects[e].prop,"")},mounted:function(){this.$emit("change",this.query)},methods:{inputChange:function(){var t=this;this.$refs["form"].validate((function(e){e&&t.$emit("change",t.query)}))},selectChange:function(){var t=this;this.$refs["form"].validate((function(e){e&&t.$emit("change",t.query)}))},handleQuery:function(){var t=this;this.$refs["form"].validate((function(e){e&&t.$emit("change",t.query)}))},resetForm:function(){this.$refs["form"].resetFields(),this.$emit("change",this.query)}}},o=r,l=n("2877"),s=Object(l["a"])(o,a,i,!1,null,"51637e54",null);e["a"]=s.exports}}]);