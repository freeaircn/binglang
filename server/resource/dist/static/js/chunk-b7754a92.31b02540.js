(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b7754a92"],{"23a5":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"head-container"},[a("div",[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",size:"small",placeholder:"搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.query.words,callback:function(t){e.$set(e.query,"words",t)},expression:"query.words"}}),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")]),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:e.preCreate}},[e._v("新增")])],1)]),e._v(" "),a("el-divider",[a("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"table",attrs:{data:e.tableToPage,"row-key":"id",size:"small","header-cell-style":{background:"#F2F6FC",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"employee_number",label:"工号"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"username",label:"中文名"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"sex",label:"性别"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"phone",label:"手机号"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"email",label:"电子邮箱"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"dept_label",label:"部门"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"job_label",label:"岗位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"enabled",label:"是否启用",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.enabled?a("span",[e._v("是")]):a("span",[e._v("否")])]}}])}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"last_login",label:"登录日期"}}),e._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ip_address",label:"登录IP"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_time",label:"更新日期"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"130px",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(t){return e.preUpdate(l.id)}}}),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.doDelete(l.id)}}})]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"page-sizes":[5,10,30,50],"page-size":e.pageSize,"current-page":e.pageIdx,layout:"total, prev, pager, next, sizes",total:e.pageTotalContent},on:{"size-change":e.pageSizeChange,"current-change":e.pageIdxChange}}),e._v(" "),a("el-dialog",{attrs:{"append-to-body":"","close-on-click-modal":!1,visible:e.dialogVisible,title:e.dialogActionMap[e.dialogAction],width:"480px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tabs",{attrs:{"tab-position":"left"},model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[a("el-tab-pane",{attrs:{name:"basic_info",label:"基本信息"}},[a("el-form",{ref:"form_basic_info",attrs:{model:e.formData,rules:e.rules,size:"mini","label-width":"80px"}},[a("el-form-item",{attrs:{label:"中文名",prop:"username"}},[a("el-input",{model:{value:e.formData.username,callback:function(t){e.$set(e.formData,"username",t)},expression:"formData.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-input",{model:{value:e.formData.sex,callback:function(t){e.$set(e.formData,"sex",t)},expression:"formData.sex"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{model:{value:e.formData.phone,callback:function(t){e.$set(e.formData,"phone",t)},expression:"formData.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[a("el-input",{model:{value:e.formData.email,callback:function(t){e.$set(e.formData,"email",t)},expression:"formData.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{"show-password":"",autocomplete:"off"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"enabled"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.formData.enabled,callback:function(t){e.$set(e.formData,"enabled",t)},expression:"formData.enabled"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("是")]),e._v(" "),a("el-radio-button",{attrs:{label:"0"}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"所属角色",prop:"role"}},[a("el-select",{attrs:{multiple:"",placeholder:"授予权限，可多选"},model:{value:e.formData.role_id,callback:function(t){e.$set(e.formData,"role_id",t)},expression:"formData.role_id"}},e._l(e.roleList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{name:"more_info",label:"更多信息"}},[a("el-form",{ref:"form_more_info",attrs:{model:e.formData,rules:e.rules,size:"mini","label-width":"80px"}},[a("el-form-item",{attrs:{label:"身份证号",prop:"identity_document_number"}},[a("el-input",{model:{value:e.formData.identity_document_number,callback:function(t){e.$set(e.formData,"identity_document_number",t)},expression:"formData.identity_document_number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"工号",prop:"employee_number"}},[a("el-input",{model:{value:e.formData.employee_number,callback:function(t){e.$set(e.formData,"employee_number",t)},expression:"formData.employee_number"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门",prop:"dept_id"}},[a("treeSelect",{attrs:{options:e.deptList,placeholder:"选择部门"},model:{value:e.formData.dept_id,callback:function(t){e.$set(e.formData,"dept_id",t)},expression:"formData.dept_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"岗位",prop:"job_id"}},[a("el-select",{attrs:{placeholder:"选择岗位"},model:{value:e.formData.job_id,callback:function(t){e.$set(e.formData,"job_id",t)},expression:"formData.job_id"}},e._l(e.jobList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1),e._v(" "),e._l(e.extraAttributeList,(function(t,l){return a("el-form-item",{key:l,attrs:{label:t.label,prop:t.label}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formData.extra_attributes[l],callback:function(t){e.$set(e.formData.extra_attributes,l,t)},expression:"formData.extra_attributes[index]"}},e._l(t.values,(function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})})),1)],1)}))],2)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){"create"===e.dialogAction?e.doCreate():e.doUpdate()}}},[e._v("提交")])],1)],1)],1)},o=[],i=(a("6c7b"),a("ca17")),n=a.n(i),r=(a("542c"),a("c179")),s=a("b775");function c(e){return Object(s["a"])({url:"/api/user",method:"get",params:e})}function u(e){return Object(s["a"])({url:"/api/user",method:"put",data:e})}function d(e){return s["a"].delete("/api/user",{data:{id:e}})}var p={name:"AdminUser",components:{treeSelect:n.a},data:function(){return{query:{words:""},tableLoading:!1,tableData:[],pageTotalContent:0,pageSize:5,pageIdx:1,dialogVisible:!1,dialogAction:"",dialogActionMap:{update:"编辑",create:"新建"},tabIndex:"basic_info",formData:{id:null,employee_number:"",username:"",sex:"",identity_document_number:"",phone:"",email:"",enabled:"1",dept_id:null,job_id:null,password:"",role_id:[],extra_attributes:[]},roleList:[],extraAttributeList:[],deptList:[],jobList:[],rules:{}}},computed:{tableToPage:function(){return 0!==this.tableData.length?this.tableData.slice((this.pageIdx-1)*this.pageSize,this.pageIdx*this.pageSize):[]}},created:function(){this.updateTbl(null)},methods:{updateTbl:function(e){this.tableLoading=!0,null===e&&(e={select_col:null,method:null,cond:null,cond_col:null}),c(e).then(function(e){this.tableData.splice(0,this.tableData.length),this.pageTotalContent=e.slice(0).length,this.tableData=e.slice(0)}.bind(this)).catch((function(e){console.log(e)})).finally(function(){this.tableLoading=!1}.bind(this))},handleQuery:function(){if(""===this.query.words)this.updateTbl(null);else{var e=Object(r["b"])(this.query.words);if(!0===e){var t={select_col:null,method:"like",cond:{label:this.query.words},cond_col:null};this.updateTbl(t)}else this.$notify.error({title:"错误",message:e,duration:2e3})}},preCreate:function(){this.rstFormData();var e={wanted:"new_form"};c(e).then(function(e){var t=this;this.roleList.splice(0,this.roleList.length),this.roleList=e[0].role.slice(0),this.deptList.splice(0,this.deptList.length),this.deptList=e[0].dept.slice(0),this.jobList.splice(0,this.jobList.length),this.jobList=e[0].job.slice(0),this.extraAttributeList.splice(0,this.extraAttributeList.length),this.extraAttributeList=e[0].extra_attribute.slice(0);var a=this.extraAttributeList.length;this.extra_attributes=new Array(a).fill(0),this.dialogAction="create",this.dialogVisible=!0,this.$nextTick((function(){t.$refs["form"].clearValidate()}))}.bind(this)).catch((function(e){console.log(e)}))},doCreate:function(){var e=this;this.$refs["form"].validate((function(t){t&&console.log(e.formData)}))},preUpdate:function(e){var t={select_col:null,method:null,cond:null,cond_col:null};c(t).then(function(e){var t=this;this.treeData.splice(0,this.treeData.length),this.treeData=e[0].slice(0),this.copyFormData(e[1][0]),this.dialogAction="update",this.dialogVisible=!0,this.$nextTick((function(){t.$refs["form"].clearValidate()}))}.bind(this)).catch((function(e){console.log(e)}))},doUpdate:function(){var e=this;this.$refs["form"].validate((function(t){if(t){var a=Object.assign({},e.formData);u(a).then(function(e){this.dialogAction="",this.dialogVisible=!1,this.updateTbl(null)}.bind(e)).catch((function(e){console.log(e)}))}}))},doDelete:function(e){var t=this;this.$confirm("确定删除吗？此操作不能撤销！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){d(e).then(function(e){this.$message({type:"success",message:"删除成功!"}),this.updateTbl(null)}.bind(t)).catch((function(e){console.log(e)}))})).catch((function(){}))},rstFormData:function(){this.formData.id=null,this.formData.employee_number="",this.formData.username="",this.formData.sex="",this.formData.phone="",this.formData.email="",this.formData.enabled="1",this.formData.dept_id=null,this.formData.job_id=null,this.formData.password="",this.formData.role_id=[],this.formData.extra_attributes=[]},copyFormData:function(e){this.formData=JSON.parse(JSON.stringify(e))},pageSizeChange:function(e){this.pageSize=e},pageIdxChange:function(e){this.pageIdx=e}}},m=p,f=a("2877"),b=Object(f["a"])(m,l,o,!1,null,null,null);t["default"]=b.exports},"36bd":function(e,t,a){"use strict";var l=a("4bf8"),o=a("77f1"),i=a("9def");e.exports=function(e){var t=l(this),a=i(t.length),n=arguments.length,r=o(n>1?arguments[1]:void 0,a),s=n>2?arguments[2]:void 0,c=void 0===s?a:o(s,a);while(c>r)t[r++]=e;return t}},"6c7b":function(e,t,a){var l=a("5ca1");l(l.P,"Array",{fill:a("36bd")}),a("9c6c")("fill")},c179:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return n}));var l=/^([0-9a-zA-Z\u4e00-\u9fa5]){2,20}$/,o=/^([0-9a-zA-Z\u4e00-\u9fa5]){2,8}$/;function i(e,t,a){return t&&l.test(t)?void a():a(new Error("请输入中文/英文/数字，长度2~20"))}function n(e){return!e||(!!o.test(e)||"请输入中文/英文/数字，长度2~8")}}}]);