(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b7754a92"],{"23a5":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"head-container"},[a("div",[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",size:"small",placeholder:"搜索"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleQuery(e)}},model:{value:t.query.words,callback:function(e){t.$set(t.query,"words",e)},expression:"query.words"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"success",icon:"el-icon-search"},on:{click:t.handleQuery}},[t._v("查询")]),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:t.preCreate}},[t._v("新增")])],1)]),t._v(" "),a("el-divider",[a("i",{staticClass:"el-icon-arrow-down"})]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],ref:"table",attrs:{data:t.tableToPage,"row-key":"id",size:"small","header-cell-style":{background:"#F2F6FC",color:"#606266"}}},[a("el-table-column",{attrs:{prop:"employee_number",label:"工号"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"username",label:"中文名"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"sex",label:"性别",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.sex?a("span",[t._v("女")]):a("span",[t._v("男")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"phone",label:"手机号"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"email",label:"电子邮箱"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"identity_document_number",label:"身份证号"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"dept_label",label:"部门"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"job_label",label:"岗位"}}),t._v(" "),a("el-table-column",{attrs:{prop:"enabled",label:"是否启用",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.enabled?a("span",[t._v("是")]):a("span",[t._v("否")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"last_login",label:"登录日期"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"ip_address",label:"登录IP"}}),t._v(" "),a("el-table-column",{attrs:{prop:"update_time",label:"更新日期"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"130px",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(e){return t.preUpdate(i.id)}}}),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(e){return t.doDelete(i.id)}}})]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"page-sizes":[5,10,30,50],"page-size":t.pageSize,"current-page":t.pageIdx,layout:"total, prev, pager, next, sizes",total:t.pageTotalContent},on:{"size-change":t.pageSizeChange,"current-change":t.pageIdxChange}}),t._v(" "),a("el-dialog",{attrs:{"append-to-body":"","close-on-click-modal":!1,visible:t.dialogVisible,title:t.dialogActionMap[t.dialogAction],width:"480px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-tabs",{attrs:{"tab-position":"left","before-leave":t.leaveTab},model:{value:t.tabIndex,callback:function(e){t.tabIndex=e},expression:"tabIndex"}},[a("el-tab-pane",{attrs:{name:"tab_one",label:"基本信息"}},[a("el-form",{ref:"form_tab_one",attrs:{model:t.formData,rules:t.rules_tab_one,size:"mini","label-width":"80px"}},[a("el-form-item",{attrs:{label:"中文名",prop:"username"}},[a("el-input",{model:{value:t.formData.username,callback:function(e){t.$set(t.formData,"username",e)},expression:"formData.username"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-radio-group",{model:{value:t.formData.sex,callback:function(e){t.$set(t.formData,"sex",e)},expression:"formData.sex"}},[a("el-radio",{attrs:{label:"0"}},[t._v("男")]),t._v(" "),a("el-radio",{attrs:{label:"1"}},[t._v("女")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[a("el-input",{model:{value:t.formData.phone,callback:function(e){t.$set(t.formData,"phone",e)},expression:"formData.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"电子邮箱",prop:"email"}},[a("el-input",{model:{value:t.formData.email,callback:function(e){t.$set(t.formData,"email",e)},expression:"formData.email"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{"show-password":"",autocomplete:"off"},model:{value:t.formData.password,callback:function(e){t.$set(t.formData,"password",e)},expression:"formData.password"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"是否启用",prop:"enabled"}},[a("el-radio-group",{model:{value:t.formData.enabled,callback:function(e){t.$set(t.formData,"enabled",e)},expression:"formData.enabled"}},[a("el-radio",{attrs:{label:"1"}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:"0"}},[t._v("否")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"所属角色",prop:"role"}},[a("el-select",{attrs:{multiple:"",placeholder:"授予权限，可多选"},model:{value:t.formData.role_ids,callback:function(e){t.$set(t.formData,"role_ids",e)},expression:"formData.role_ids"}},t._l(t.roleList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})})),1)],1)],1)],1),t._v(" "),a("el-tab-pane",{attrs:{name:"tab_two",label:"更多信息"}},[a("el-form",{ref:"form_tab_two",attrs:{model:t.formData,rules:t.rules_tab_two,size:"mini","label-width":"80px"}},[a("el-form-item",{attrs:{label:"身份证号",prop:"identity_document_number"}},[a("el-input",{model:{value:t.formData.identity_document_number,callback:function(e){t.$set(t.formData,"identity_document_number",e)},expression:"formData.identity_document_number"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"工号",prop:"employee_number"}},[a("el-input",{model:{value:t.formData.employee_number,callback:function(e){t.$set(t.formData,"employee_number",e)},expression:"formData.employee_number"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"部门",prop:"dept_id"}},[a("treeSelect",{attrs:{options:t.deptList,placeholder:"选择部门"},model:{value:t.formData.dept_id,callback:function(e){t.$set(t.formData,"dept_id",e)},expression:"formData.dept_id"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"岗位",prop:"job_id"}},[a("el-select",{attrs:{placeholder:"选择岗位"},model:{value:t.formData.job_id,callback:function(e){t.$set(t.formData,"job_id",e)},expression:"formData.job_id"}},t._l(t.jobList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})})),1)],1),t._v(" "),t._l(t.extraAttributeList,(function(e,i){return a("el-form-item",{key:i,attrs:{label:e.label,prop:e.label}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.extra_attributes[i],callback:function(e){t.$set(t.formData.extra_attributes,i,e)},expression:"formData.extra_attributes[index]"}},t._l(e.values,(function(t){return a("el-option",{key:t.id,attrs:{label:t.label,value:t.id}})})),1)],1)}))],2)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.cancelDialog()}}},[t._v("取消")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"tab_one"==t.tabIndex,expression:"tabIndex == 'tab_one'"}],attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.toNextTab()}}},[t._v("下一页")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"tab_two"==t.tabIndex,expression:"tabIndex == 'tab_two'"}],attrs:{type:"primary",size:"mini"},on:{click:function(e){"create"===t.dialogAction?t.doCreate():t.doUpdate()}}},[t._v("提交")])],1)],1)],1)},o=[],l=(a("6c7b"),a("ca17")),r=a.n(l),n=(a("542c"),a("c179")),s=a("b775");function d(t){return Object(s["a"])({url:"/api/user",method:"get",params:t})}function c(t){return Object(s["a"])({url:"/api/user",method:"post",data:t})}function u(t){return Object(s["a"])({url:"/api/user",method:"put",data:t})}function m(t){return s["a"].delete("/api/user",{data:{id:t}})}var p={name:"AdminUser",components:{treeSelect:r.a},data:function(){return{query:{words:""},tableLoading:!1,tableData:[],pageTotalContent:0,pageSize:5,pageIdx:1,dialogVisible:!1,dialogAction:"",dialogActionMap:{update:"编辑",create:"新建"},tabIndex:"tab_one",formData:{id:null,username:"",sex:"0",phone:"",email:"",password:"",enabled:"1",role_ids:[],identity_document_number:"",employee_number:"",dept_id:null,job_id:null,extra_attributes:[]},roleList:[],extraAttributeList:[],deptList:[],jobList:[],rules_tab_one:{username:[{required:!0,validator:n["a"],trigger:"change"}],phone:[{required:!0,validator:n["d"],trigger:"change"}],email:[{required:!0,validator:n["b"],trigger:"change"}]}}},computed:{tableToPage:function(){return 0!==this.tableData.length?this.tableData.slice((this.pageIdx-1)*this.pageSize,this.pageIdx*this.pageSize):[]}},created:function(){this.updateTbl({wanted:"all"})},methods:{updateTbl:function(t){this.tableLoading=!0,d(t).then(function(t){this.pageTotalContent=t.users.slice(0).length,this.tableData.splice(0),this.tableData=t.users.slice(0)}.bind(this)).catch(function(t){this.tableData.splice(0),this.$message({message:t,type:"warning"})}.bind(this)).finally(function(){this.tableLoading=!1}.bind(this))},preCreate:function(){this.rstFormData(),this.roleList.splice(0),this.deptList.splice(0),this.jobList.splice(0),this.extraAttributeList.splice(0),this.tabIndex="tab_one",d({wanted:"new_form"}).then(function(t){var e=this;this.roleList=t.role.slice(0),this.deptList=t.dept.slice(0),this.jobList=t.job.slice(0),this.extraAttributeList=t.extra_attribute.slice(0);var a=this.extraAttributeList.length;this.formData.extra_attributes=new Array(a).fill(""),this.dialogAction="create",this.dialogVisible=!0,this.$nextTick((function(){e.$refs["form_tab_one"].clearValidate(),e.$refs["form_tab_two"].clearValidate()}))}.bind(this)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(this))},toNextTab:function(){var t=this;this.$refs["form_tab_one"].validate((function(e){e&&(t.tabIndex="tab_two")}))},leaveTab:function(t,e){if(!0===this.dialogVisible){if("tab_one"===e)return this.$refs["form_tab_one"].validate();if("tab_two"===e)return this.$refs["form_tab_two"].validate()}},doCreate:function(){var t=this;this.$refs["form_tab_two"].validate((function(e){e&&c(t.formData).then(function(t){this.dialogAction="",this.dialogVisible=!1,this.updateTbl({wanted:"all"})}.bind(t)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(t))}))},preUpdate:function(t){this.rstFormData(),this.roleList.splice(0),this.deptList.splice(0),this.jobList.splice(0),this.extraAttributeList.splice(0),this.tabIndex="tab_one",d({wanted:"current_form",uid:t}).then(function(t){var e=this;this.roleList=t.lists.role.slice(0),this.deptList=t.lists.dept.slice(0),this.jobList=t.lists.job.slice(0),this.extraAttributeList=t.lists.extra_attribute.slice(0),this.updateFormData(t.user),this.dialogAction="update",this.dialogVisible=!0,this.$nextTick((function(){e.$refs["form_tab_one"].clearValidate(),e.$refs["form_tab_two"].clearValidate()}))}.bind(this)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(this))},doUpdate:function(){var t=this;this.$refs["form_tab_two"].validate((function(e){e&&u(t.formData).then(function(t){this.dialogAction="",this.dialogVisible=!1,this.updateTbl({wanted:"all"})}.bind(t)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(t))}))},doDelete:function(t){var e=this;this.$confirm("确定删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){m(t).then(function(){this.updateTbl({wanted:"all"})}.bind(e)).catch(function(t){this.$message({message:t,type:"warning"})}.bind(e))})).catch((function(){}))},rstFormData:function(){this.formData.id=null,this.formData.employee_number="",this.formData.username="",this.formData.sex="0",this.formData.identity_document_number="",this.formData.phone="",this.formData.email="",this.formData.enabled="1",this.formData.dept_id=null,this.formData.job_id=null,this.formData.password="",this.formData.role_ids.splice(0),this.formData.extra_attributes.splice(0)},updateFormData:function(t){this.formData.id=t.id,this.formData.employee_number=t.employee_number,this.formData.username=t.username,this.formData.sex=t.sex,this.formData.identity_document_number=t.identity_document_number,this.formData.phone=t.phone,this.formData.email=t.email,this.formData.enabled=t.enabled,this.formData.dept_id=t.dept_id,this.formData.job_id=t.job_id,this.formData.password="",this.formData.role_ids=t.role_ids.slice(0),this.formData.extra_attributes=t.extra_attributes.slice(0)},pageSizeChange:function(t){this.pageSize=t},pageIdxChange:function(t){this.pageIdx=t},cancelDialog:function(){this.dialogAction="",this.dialogVisible=!1},handleQuery:function(){if(this.a=b,""===this.query.words)this.updateTbl({wanted:"all"});else{var t=Object(n["e"])(this.query.words);if(!0===t){var e={select_col:null,method:"like",cond:{label:this.query.words},cond_col:null};this.updateTbl(e)}else this.$message({message:t,type:"warning"})}}}},f=p,h=a("2877"),_=Object(h["a"])(f,i,o,!1,null,null,null);e["default"]=_.exports},"36bd":function(t,e,a){"use strict";var i=a("4bf8"),o=a("77f1"),l=a("9def");t.exports=function(t){var e=i(this),a=l(e.length),r=arguments.length,n=o(r>1?arguments[1]:void 0,a),s=r>2?arguments[2]:void 0,d=void 0===s?a:o(s,a);while(d>n)e[n++]=t;return e}},"6c7b":function(t,e,a){var i=a("5ca1");i(i.P,"Array",{fill:a("36bd")}),a("9c6c")("fill")},c179:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return d})),a.d(e,"e",(function(){return c}));var i=/^([\u4e00-\u9fa5]){2,8}$/,o=/^[1][3,4,5,7,8][0-9]{9}$/,l=/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/,r=/^([0-9a-zA-Z\u4e00-\u9fa5]){2,8}$/;function n(t,e,a){return e&&i.test(e)?void a():a(new Error("请输入中文，字数2~8"))}function s(t,e,a){return e&&o.test(e)?void a():a(new Error("请输入11位手机号码"))}function d(t,e,a){return e&&l.test(e)?void a():a(new Error("请输入有效的电子邮箱"))}function c(t){return!t||(!!r.test(t)||"请输入中文/英文/数字，长度2~8")}}}]);